# 游戏IO
## 格式
[io.policy.drawio](imgs/io.policy.drawio)

Chunk Unit布局

| Chunk Head             | Chunk Data   |
|------------------------|--------------|
| size                   | data         |
| uint64 / little endian | protobuf msg |

## 顺序
任何序列化操作应当先co_yield区块长度，待协程恢复后才可以进行序列化操作。

## 异常处理
序列化需尽可能从逻辑错误中恢复，或至少跳过存在逻辑错误的部分。
所有Chunk Unit各自处理自身的逻辑错误，若该部分抛出异常，如果流仍然正常，上层处理函数应当推进流走到区段末尾，并放弃该段的反序列化结果；若发生自身无法处理的异常，则直接throw重抛出交给上层处理。若发生任何硬错误（如流异常），向上传递硬错误异常，且不再对流做任何操作；若上游的流仍然正常，则尝试跳过该区段继续执行反序列化。在序列化发起处应捕获所有异常，抛弃所有结果并直接终止序列化。

- 软错误：如protobuf解析错误，游戏本身判别产生的错误
- 硬错误：流自身出现错误，主要源自文件损坏
