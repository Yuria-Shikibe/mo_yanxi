# ECS

## TODO
* 组件间不变式的自动初始化：如碰撞箱的变化跟随主变换

## 实体有效性
* 任何实体的资源的添加必须延迟到帧后，添加实体的立即调用仅返回对实体的一个引用，其资源将在下一帧有效，即使它是被有状态添加的
* 对实体的延迟添加/释放（标记）操作是线程安全的
* 若实体已经有效，那么它所有资源的引用和实体本身的引用的有效性至少保留到当前帧结束
* 实体必须被**显式**标记过期。即使引用计数归零，实体仍然会保留
* 实体本身的引用仅当引用计数归零时由Manger释放并失效
* 任何**跨帧保有**对其它实体引用的对象应当在每帧检查被引用实体是否仍旧有效，并主动释放已失效实体

## ECS主循环

1. 添加